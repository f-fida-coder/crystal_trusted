"use strict";(self.webpackChunkscnsoft_website=self.webpackChunkscnsoft_website||[]).push([[7355],{16245:(e,t,s)=>{s(70886);var a=s(6599),i=s(72163),l=s(4002),r=s.n(l),n=s(67469),o=s(39405);class c{constructor(){this.$wrapper=r()(".testimonial-page"),this.$testimonialLink=this.$wrapper.find(".testimonial-page-original-link"),this.$shareTestimonialLink=this.$wrapper.find(".share-testimonial-link"),"scrollRestoration"in history&&(history.scrollRestoration="manual"),this.$testimonialLink.on("click",this.onTestimonialLinkClick.bind(this)),this.$shareTestimonialLink.on("click",this.onShareTestimonialLinkClick.bind(this)),this.$testimonialLink&&this.$testimonialLink.on("click",this.onTestimonialLinkClick.bind(this))}onTestimonialLinkClick(e){e.preventDefault();const t=r()(e.currentTarget),s=t.data("scan"),a=t.data("title");if(!s)return;const i=r()(".read-original-testimonial-modal"),l=r()("<img>").attr("src",s);i.find(".modal-content").html(l),i.find(".modal-title").text(a);new n.Z(i.first()).open()}onShareTestimonialLinkClick(e){e.preventDefault();const t=r()(e.currentTarget),s=t.closest(".share-testimonial-link-container").find(".share-testimonial-link-tooltip");if((0,o.Z)(t.attr("href")),+s.data("running"))return;const a=s.text(),i=s.data("on-copy");s.text(i).data("running",1),setTimeout((function(){s.text(a).data("running",0)}),3e3)}}var h,d,u=s(5504);function g(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}Stimulus.register("testimonials-main",(d=h=class extends a.Qr{constructor(){super(...arguments),g(this,"initialized",!1),g(this,"searchedIds",null),g(this,"MIN_QUERY_LENGTH",2)}connect(){this.initialized=!0,this.testimonialsPage=new c}handleClickTab(e){const t=e.currentTarget.dataset.tab;this.activeTabValue=this.activeTabValue===t?"":t}handleCloseDialog(){this.dialogOutlet.close(),this.activeTabValue=""}handleBackdropCloseDialog(e){e.target===this.dialogOutlet.dialogTarget&&(this.dialogOutlet.close(),this.activeTabValue="")}handleClickFilter(e){e.preventDefault(),e.stopPropagation();const t=+e.currentTarget.dataset.filterId;this.selectedFilterIdsValue.includes(t)?this.selectedFilterIdsValue=this.selectedFilterIdsValue.filter((e=>e!==t)):this.selectedFilterIdsValue=[...this.selectedFilterIdsValue,t],(0,i.L9)(this.element.dataset.trackSource,"filter",e.currentTarget.dataset.trackText,"Click")}handleClickRemoveFilterBadge(e){const t=e.currentTarget.closest(".tp-filter-badge").dataset.filterId;"search"===t?this.queryValue="":this.selectedFilterIdsValue=this.selectedFilterIdsValue.filter((e=>e!==+t)),(0,i.L9)(this.element.dataset.trackSource,"filter",e.currentTarget.closest(".tp-filter-badge").innerText,"Delete")}handleClickClearAllFilterBadges(){this.selectedFilterIdsValue=[],this.queryValue=""}handleClickShowMoreBtn(){this.pageValue++,this.showMoreBtnTarget.classList.add("disabled"),this.fetchData().then((()=>{this.scrollForMoreTestimonialsValue=!0,this.showMoreBtnTarget.classList.remove("disabled")}))}handleClickClearSearch(){this.queryValue="",this.searchInputTarget.value=""}handleSearch(){this.queryValue=this.searchInputTarget.value}handleAppearMoreTestimonialsBtn(){this.scrollForMoreTestimonialsValue&&(this.scrollForMoreTestimonialsValue=!1,this.pageValue++,this.fetchData().then((()=>this.scrollForMoreTestimonialsValue=!0)))}handleClickFilterItemsBtn(){(0,u.Z)(this.searchInputTarget,600)}handleCloseFilters(){this.activeTabValue=""}activeTabValueChanged(){const e=window.matchMedia("(max-width: 767px)").matches;this.tabButtonTargets.forEach((e=>e.classList.toggle("active",this.activeTabValue===e.dataset.tab))),this.tabFiltersTargets.forEach((t=>{const s=this.activeTabValue===t.dataset.tab;t.classList.toggle("active",s),e&&s&&(this.dialogTitleTarget.innerHTML=t.dataset.tabTitle,this.dialogBodyTarget.innerHTML=t.outerHTML,this.dialogOutlet.open())}))}selectedFilterIdsValueChanged(e){this.filterTargets.forEach((t=>{const s=e.includes(+t.dataset.filterId);t.classList.toggle("active",s),t.querySelector('input[type="checkbox"]').toggleAttribute("checked",s)})),this.tabButtonTargets.forEach((e=>{const t=null!==this.element.querySelector(`[data-tab="${e.dataset.tab}"] .tp-filter.active`);e.classList.toggle("has-selected-filters",t)})),this.syncBadgeFilters(),this.pageValue=1,this.element.classList.add("loading"),this.fetchData().then((()=>this.element.classList.remove("loading")))}availableFilterIdsValueChanged(e){this.filterTargets.forEach((t=>{const s=e.includes(+t.dataset.filterId);t.classList.toggle("disabled",!s)}))}queryValueChanged(e){this.initialized&&(e||(this.searchedIds=null,this.resetSearchResultsFromTestimonials()),this.searchInputTarget.value=e,e&&e.length<this.MIN_QUERY_LENGTH||(this.syncBadgeFilters(),this.pageValue=1,this.element.classList.add("loading"),this.fetchData().then((()=>this.element.classList.remove("loading")))))}pageValueChanged(e){1===e&&(this.scrollForMoreTestimonialsValue=!1)}syncBadgeFilters(){this.filterBadgeTargets.forEach((e=>e.remove())),this.selectedFilterIdsValue.forEach((e=>{const t=this.filterTargets.filter((t=>e===+t.dataset.filterId))[0];if(t){const s=t.querySelector(".tp-filter-name").innerText.trim();this.addBadgeFilter(e,s)}})),this.queryValue&&this.queryValue.length>=this.MIN_QUERY_LENGTH&&this.addBadgeFilter("search",this.queryValue),this.appliedFiltersTarget.classList.contains("active")||(this.totalTarget.innerHTML=""),this.appliedFiltersTarget.classList.toggle("active",this.selectedFilterIdsValue.length>0||this.queryValue.length>=this.MIN_QUERY_LENGTH)}addBadgeFilter(e,t){const s=this.filterBadgeTemplateTarget,a=s.content.cloneNode(!0);a.querySelector(".tp-filter-badge").dataset.filterId=e,a.querySelector(".tp-filter-badge-name").innerText=t,s.parentNode.insertBefore(a,s)}async fetchData(){var e=this;if(this.queryValue&&this.queryValue.length>=this.MIN_QUERY_LENGTH&&1===this.pageValue){const e=new URLSearchParams({query:this.queryValue,language}),t=await fetch(`${this.searchUrlValue}?${e.toString()}`),s=await t.json();this.searchedIds=s.results.map((e=>+e.id)),this.mapSearchResultsToTestimonials(s.results)}const t={};this.tabFiltersTargets.forEach((e=>{const s=e.dataset.tab,a=e.querySelectorAll(".tp-filter.active");a.length&&(t[s]=[...a].map((e=>+e.dataset.filterId)))}));const s=function(t,s,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!==e.searchedIds&&!e.searchedIds.includes(t))return!1;for(const[e,t]of Object.entries(a))if(e!==i&&0===t.filter((e=>s.includes(e))).length)return!1;return!0};let a=this.pageValue*this.perPageValue,i=0,l=0,r=this.testimonialTargets;null!==this.searchedIds&&(this.testimonialTargets.forEach((e=>e.classList.remove("active"))),r=this.searchedIds.map((e=>this.itemsTarget.querySelector(`[data-id="${e}"]`))).filter((e=>e))),r.forEach((e=>{const r=+e.dataset.id,n=e.dataset.filterIds.split(",").map((e=>+e)),o=s(r,n,t),c=l<a&&o;e.classList.toggle("active",c),c&&l++,c&&e.classList.contains("video")&&a--,o&&i++}));const n=[];this.tabButtonTargets.forEach((e=>{const a=e.dataset.tab,i=e.dataset.filterIds.split(",").map((e=>+e));this.testimonialTargets.forEach((e=>{const l=+e.dataset.id,r=e.dataset.filterIds.split(",").map((e=>+e));s(l,r,t,a)&&r.forEach((e=>{i.includes(e)&&!n.includes(e)&&n.push(e)}))}))})),this.totalTarget.innerText=i,this.showMoreBtnTotalTarget.innerText=` (${i-l})`,this.showMoreBtnTarget.classList.toggle("hidden",this.pageValue*this.perPageValue>=i),this.element.classList.toggle("no-results",0===i),this.availableFilterIdsValue=n,editmode||1!==this.pageValue||this.element.classList.contains("single")||history.replaceState({},null,this.generateCurrentUrl())}generateCurrentUrl(){const e={};let t=this.selectedFilterIdsValue;this.selectedFilterIdsValue.sort().join(",")===this.activeFilterIdsValue.sort().join(",")&&(t=[]),t.length&&(e.filterIds=t.join("_")),this.queryValue&&(e.query=this.queryValue);const s=new URLSearchParams(e);return`${this.urlValue}${s.toString()?"?"+s.toString():""}`}mapSearchResultsToTestimonials(e){this.resetSearchResultsFromTestimonials(),e.forEach(((e,t)=>{const s=e.id,a=e.companyNameHighlightHtml,i=e.companyDescriptionHighlightHtml,l=e.shortTextHighlightHtml,r=e.fullTextHighlightHtml,n=this.itemsTarget.querySelector(`[data-id="${s}"]`);if(!n)return;n.style.order=t-1e3+"",n.classList.add("tp-search-order");const o=n.querySelector(".tp-search-company-name");o&&a&&(o.classList.add("active"),o.innerHTML=a);const c=n.querySelector(".tp-search-company-desc");c&&i&&(c.classList.add("active"),c.innerHTML=i);const h=n.querySelector(".tp-search-short");h&&l&&(h.classList.add("active"),h.innerHTML=`<p>${l}</p>`);const d=n.querySelector(".tp-search-full");if(d&&r){const e=d.dataset.title;d.classList.add("active"),d.innerHTML=`\n                    <p class="text-size-sm mb-4 mt-20 text-gray-700 leading-170">${e}</p>\n                    <p class="m-0 text-size-lg text-gray leading-178 bg-yellow-100 px-8">“...${r}...“</p>\n                `}}))}resetSearchResultsFromTestimonials(){this.itemsTarget.querySelectorAll(".tp-search-result").forEach((e=>{e.classList.remove("active"),e.innerHTML=""})),this.itemsTarget.querySelectorAll(".tp-search-order").forEach((e=>{e.style.order="",e.classList.remove("tp-search-order")}))}},g(h,"outlets",["dialog"]),g(h,"targets",["searchInput","tabButton","tabFilters","filter","appliedFilters","total","filterBadgeTemplate","filterBadge","items","testimonial","showMoreBtn","showMoreBtnTotal","dialogBody","dialogTitle"]),g(h,"values",{url:String,searchUrl:String,page:Number,perPage:Number,activeTab:String,selectedFilterIds:Array,availableFilterIds:Array,scrollForMoreTestimonials:Boolean,query:String,activeFilterIds:Array}),d))}},e=>{e.O(0,[3913,6599,886,2163,5504,9405,7469],(()=>{return t=16245,e(e.s=t);var t}));e.O()}]);