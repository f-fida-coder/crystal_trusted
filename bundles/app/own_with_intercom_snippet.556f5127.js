"use strict";(self.webpackChunkscnsoft_website=self.webpackChunkscnsoft_website||[]).push([[6803],{84371:(t,e,s)=>{var i=s(4002),n=s.n(i),a=s(34474),r=s(31955);function o(t){return new Promise((e=>setTimeout(e,t)))}var p=s(72163);function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}n()(document).ready((()=>{if(!editmode&&+r.Z.get("own_with_intercom_sent_message"))return void a.default.onLoad((()=>Intercom("update",{hide_default_launcher:!1})));const t=n()(".own-with-intercom-snippet");editmode&&!t.closest(".snippet-content.editmode").length||(editmode?window.OwnWithIntercom=new h(t):a.default.onLoad((()=>window.OwnWithIntercom=new h(t))))}));class h{constructor(t){d(this,"MESSAGE_SHOW_TIME",500),d(this,"disableCollapse",!1),d(this,"animationStarted",!1),this.$snippet=t,this.$wrapper=this.$snippet.find(".owis-wrapper"),this.$container=this.$wrapper.find(".ows-container"),this.$sendBtn=this.$wrapper.find(".owis-send-btn"),this.$itemsContainer=this.$wrapper.find(".owis-items-container"),this.$unread=this.$wrapper.find(".owis-unread"),this.$input=this.$wrapper.find(".owis-input[name]"),this.unredCount=0,this.itemsCount=this.$wrapper.find(".owis-message-wrapper").length,this.startDelay=+this.$wrapper.data("start-delay"),this.typingDelay=+this.$wrapper.data("typing-delay"),this.typingTime=+this.$wrapper.data("typing-time"),n()("body").addClass("hide-intercom"),this.$snippet.removeClass("hidden"),editmode?this.$wrapper.find(".owis-hidden-wrapper:not(.owis-typing-wrapper)").addClass("active"):(setTimeout((()=>!this.animationStarted&&this.initAnimation()),this.startDelay),this.$wrapper.one("click",(()=>!this.animationStarted&&this.initAnimation())),this.$input.on("keypress",this.handleInputKeyup.bind(this)),this.$sendBtn.click(this.sendEnteredMessage.bind(this)),this.$wrapper.find(".owis-close-btn").click(this.closeChat.bind(this)),this.$wrapper.click(this.handleClickChat.bind(this)))}handleInputKeyup(t){13!==t.keyCode||t.shiftKey||(t.preventDefault(),this.sendEnteredMessage())}async initAnimation(){this.animationStarted=!0,this.$wrapper.removeClass("cursor-pointer");const t=this.$wrapper.find(".owis-typing-wrapper, .owis-minimized-typing-wrapper");this.$wrapper.find(".owis-items-wrapper, .owis-form-wrapper").addClass("active");let e=null,s=0;for(let i of this.$wrapper.find(".owis-message-wrapper")){e&&await o(this.typingDelay),t.addClass("active"),await o(this.typingTime);const a=n()(i);t.removeClass("active"),a.addClass("active"),this.disableCollapse&&!this.$wrapper.hasClass("owis-minimized")||(this.unredCount+=1,(e||this.$wrapper.hasClass("owis-minimized"))&&(this.$unread.text(this.unredCount),this.$unread.addClass("active"))),!this.disableCollapse&&e&&this._collapseMessage(a,e,s),e=a,s++}}_collapseMessage(t,e,s){this.$itemsContainer.css("paddingBottom",8*s+"px"),e.css({opacity:"0",transition:`all ${.75*this.MESSAGE_SHOW_TIME}ms ease-in-out`}),t.css({position:"absolute","z-index":"30",top:"0",transition:`all ${.5*this.MESSAGE_SHOW_TIME}ms ease-in-out`}),setTimeout((()=>{t.attr("style",""),e.css({position:"absolute",height:"32px",bottom:8*(s-1)+"px",transform:`scale(${1-.02*(this.itemsCount-s)})`,opacity:1-(this.itemsCount-s)/this.itemsCount,transition:"none"}),e.find(".owis-message").css("opacity","0")}),.8*this.MESSAGE_SHOW_TIME)}closeChat(){const t=n()(".owis-contact").width()+100;this.$wrapper.addClass("owis-minimized"),this.$wrapper.css("width",t+"px")}handleClickChat(t){if(n()(t.target).closest(".owis-close-btn").length)return;this.openChat();const e=(n()(t.target).closest("[class]").attr("class")+"").split(" ").filter((t=>(t+"").includes("owis")))[0];(0,p.L9)(this.$snippet.data("track-source"),"element",`${e||"chat window"}`,"Click chat",!0)}openChat(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$wrapper.removeClass("owis-minimized"),this.$wrapper.css("width",""),this.$wrapper.find(".owis-message-wrapper, .owis-items-container, .owis-message").attr("style",""),this.$itemsContainer.removeClass("cursor-pointer"),this.unredCount=0,this.$unread.removeClass("active"),this.disableCollapse=!0,"string"==typeof t&&this.$input.val(t).focus()}sendEnteredMessage(){const t=this.$input.val();t&&(this.$sendBtn.addClass("disabled"),this.$wrapper.addClass("animate-pulse pointer-events-none"),a.default.onLoad((()=>{n().ajax({url:"/ajax/intercom-new-message",data:{user_id:Intercom("getVisitorId"),message:t},success:e=>{n()("body").removeClass("hide-intercom"),r.Z.set("own_with_intercom_sent_message",1,{expires:365}),Intercom("update",{hide_default_launcher:!1}),this.$wrapper.addClass("hidden"),window.OwnWithIntercom=null,setTimeout((()=>{e.conversationId?Intercom("showConversation",e.conversationId):Intercom("showNewMessage",t)}),1e3)}})})))}}}},t=>{t.O(0,[3913,1955,2163,9118,4474,9135,700],(()=>{return e=84371,t(t.s=e);var e}));t.O()}]);